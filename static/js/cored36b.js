function stable($var) {    $('#type').fadeOut(0);    if ($var == 1) {        $('#stable').fadeIn(0);        $('#step1').fadeIn(500);        ScrollToControl('step1');    } else {        $('#beta').fadeIn(0);        $('#beta_devices').fadeIn(500);        beta_device();    }}function beta_device() {    $.ajax({        type: "GET",        url: "api/beta/devices",        dataType: "json",        success: function (data) {            if (data.error) {                alert(data.error);            } else {                $('#beta_devices').children('.list').empty();                $.each(data, function (i) {                    var name = data[i]['name'];                    $('#beta_devices').children('.list').append("<div class=\"select-beta-devices-type\"> <div class=\"btn left big broad\"><a href=\"javascript:;\" onclick=\"beta_firmware('" + name + "')\">" + name + "</a></div></div>");                });                ScrollToControl('beta_devices');            }        }    });}//fetch_pt();function fetch_pt() {    $.ajax({        type: "GET",        url: "https://api.ibeta.me/pt",        dataType: "jsonp",        success: function (data) {            if (data.error) {                alert(data.error);            } else {                $.each(data, function (i) {                    var name = data[i]['app_id'];                    console.log(name);                });            }        }    });}function beta_firmware($var) {    $.ajax({        type: "GET",        url: "api/beta/firmwares/" + $var,        dataType: "json",        success: function (data) {            if (data.error) {                alert(data.error);            } else {                $('#beta_devices').fadeOut(0);                $('#beta_firmwarm_info').fadeIn(500);                $('#beta_details_ul').empty();                var info = {                    "device": "设备",                    "ios_version": "版本",                    "buildid": "Build ID",                    "ios_pubtime": "发布时间"                };                var $ul = $('.details').children('ul');                $.each(info, function (key, value) {                    $ul.append("<li>" + value + ": " + data[key] + "</li>");                });                var isMobile = false;                // 检测userAgent                if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {                    isMobile = true;                }                if (isMobile) {                    $("#dl_beta").attr("href", "javascript:;");                    $("#dl_beta").attr("data-clipboard-text", data['url']);                    $("#dl_beta").html("复制下载链接")                } else {                    $("#dl_beta").attr("href", data['url']);                }                ScrollToControl('beta_firmwarm_info');            }        }    });}function device($var) {    $('#step2').removeClass();    $('#step2').addClass($var);    $.ajax({        type: "GET",        url: "api/" + $var + "/condensed",        dataType: "json",        success: function (data) {            if (data.error) {                alert(data.error);            } else {                $('#step1').fadeOut(0);                $('#step2').fadeIn(500);                $('#step2').children('.list').empty();                $.each(data, function (i) {                    var name = data[i]['name'];                    var id = data[i]['identifier'];                    $('#step2').children('.list').append("<div class=\"select-devices-type\"><div class=\"btn left big broad\"><a href=\"javascript:;\" onclick=\"identifier('" + id + "')\" id=\"identifier_" + id + "\">" + name + "</a></div></div>");                });                ScrollToControl('step2');            }        }    });}function identifier($var) {    $.ajax({        type: "GET",        url: "api/" + $var + "/index/signing",        dataType: "json",        success: function (data) {            if (data.error) {                alert(data.error);            } else {                $('#step2').fadeOut(0);                $('#step3').fadeIn(500);                $('#step3').children('.list').empty();                $.each(data, function (key, value) {                    if (value['signing'] == 1) {                        var $sign = 'signing'                    } else {                        var $sign = 'stopped'                    }                    $('#step3').children('.list').append("<div class=\"btn left big narrow " + $sign + "\"><a href=\"javascript:;\" onclick=\"firmware('" + $var + "','" + key + "')\" id=\"identifier_" + key + "\">" + value['version'] + "</a></div>");                });                ScrollToControl('step3');            }        }    });}function firmware($identifier, $buldid) {    $.ajax({        type: "GET",        url: "api/" + $identifier + "/" + $buldid + "/condensed",        dataType: "json",        success: function (data) {            if (data.error) {                alert(data.error);            } else {                $('#step3').fadeOut(0);                $('.info').fadeIn(500);                $('#details_ul').empty();                var info = {                    "name": "设备",                    "identifier": "标识符",                    "version": "版本",                    "buildid": "Build ID",                    "uploaddate": "上传时间",                    "releasedate": "发布时间",                    "size": "文件大小",                    "md5sum": "MD5sum",                    "sha1sum": "SHA1sum"                };                if (!data.hasOwnProperty("releasedate")) {                    delete info['releasedate'];                }                data['size'] = bytesToSize(data['size']);                var $ul = $('.details').children('ul');                $.each(info, function (key, value) {                    $ul.append("<li>" + value + ": " + data[key] + "</li>");                });                var isMobile = false;                // 检测userAgent                if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {                    isMobile = true;                }                if (isMobile) {                    $("#downloadlink").attr("href", "javascript:;");                    $("#downloadlink").attr("data-clipboard-text", data['url']);                    $("#downloadlink").html("复制下载链接")                } else {                    $("#downloadlink").attr("href", data['url']);                }                var $cp = $(".compatibility");                var $ok = $cp.children(".ok");                var $no = $cp.children(".no");                $ok.hide();                $no.hide();                if (data['signing'] == 1) {                    $ok.show();                } else {                    $no.show();                }                ScrollToControl('info');            }        }    });}function previous_step($var) {    $('#type').fadeOut(0);    $('#step1').fadeOut(0);    $('#step2').fadeOut(0);    $('#step3').fadeOut(0);    $('.info').fadeOut(0);    $('#beta_devices').fadeOut(0);    $('#beta_firmwarm_info').fadeOut(0);    switch ($var) {        case 0:            $id = 'type';            break;        case 1:            $id = 'step1';            break;        case 2:            $id = 'step2';            break;        case 3:            $id = 'step3';            break;        case 4:            $id = 'beta_devices';            break;    }    $('#' + $id).fadeIn(500);    ScrollToControl($id);}$(document).ready(function () {    var clipboard = new ClipboardJS('#downloadlink');    clipboard.on('success', function (e) {        console.log(e);        alert('固件下载链接已拷贝到您的剪切板啦~')    });    clipboard.on('error', function (e) {        console.log(e);        alert("复制失败")    });    var clipboard2 = new ClipboardJS('#dl_beta');    clipboard2.on('success', function (e) {        console.log(e);        alert('固件下载链接已拷贝到您的剪切板啦~')    });    clipboard2.on('error', function (e) {        console.log(e);        alert("复制失败")    });});function bytesToSize(bytes) {    if (bytes === 0) return '0 B';    var k = 1024;    sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];    i = Math.floor(Math.log(bytes) / Math.log(k));    return (bytes / Math.pow(k, i)).toPrecision(3) + ' ' + sizes[i];                                                                                                       //return (bytes / Math.pow(k, i)).toPrecision(3) + ' ' + sizes[i];}function elementPosition(obj) {    var curleft = 0, curtop = 0;    if (obj.offsetParent) {        curleft = obj.offsetLeft;        curtop = obj.offsetTop;        while (obj = obj.offsetParent) {            curleft += obj.offsetLeft;            curtop += obj.offsetTop;        }    }    return {x: curleft, y: curtop};}function ScrollToControl(id) {    var elem = document.getElementById(id);    var scrollPos = elementPosition(elem).y;    var heightTop = document.documentElement.scrollTop || document.body.scrollTop;    scrollPos = scrollPos - heightTop - 70;    var remainder = scrollPos % 50;    var repeatTimes = (scrollPos - remainder) / 50;    ScrollSmoothly(scrollPos, repeatTimes);    window.scrollBy(0, remainder);}var repeatCount = 0;var cTimeout;function ScrollSmoothly(scrollPos, repeatTimes) {    if (repeatCount < repeatTimes) {        window.scrollBy(0, 50);    }    else {        repeatCount = 0;        clearTimeout(cTimeout);        return;    }    repeatCount++;    cTimeout = setTimeout("ScrollSmoothly('" + scrollPos + "','" + repeatTimes + "')", 50);}$(function () {    $('#appCardLoadMore').bind('click', function () {        $('.card-app-more').removeClass('card-app-more');        $('#appCardLoadMore').fadeOut();        $('#appCardGetMore').fadeIn();    });});